<div class="group-option" data-group-id="<%= group.id %>" data-group-name="<%= group.name.downcase %>" title="<%= group.full_path %>">
  <div class="flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer group-item" style="padding-left: <%= (level * 1.5 + 0.75) %>rem;">
    <% if group.children.any? %>
      <button type="button" 
              data-action="click->group-selector#toggleExpand"
              class="mr-1 p-0.5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors focus:outline-none"
              aria-label="Toggle expand">
        <svg class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
    <% else %>
      <span class="w-5 mr-1"></span>
    <% end %>
    
    <label class="flex items-center flex-1 cursor-pointer">
      <input type="checkbox" 
             name="workflow[group_ids][]" 
             value="<%= group.id %>"
             data-group-selector-target="checkbox"
             data-action="change->group-selector#select"
             <%= 'checked' if selected_ids.include?(group.id) %>
             class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
      <span class="ml-2 text-sm text-gray-900 dark:text-gray-100 flex-1">
        <%= group.name %>
        <% if group.description.present? %>
          <span class="text-xs text-gray-500 dark:text-gray-400 block mt-0.5"> - <%= truncate(group.description, length: 50) %></span>
        <% end %>
      </span>
    </label>
  </div>
  
  <% if group.children.any? %>
    <div class="children ml-4 border-l-2 border-gray-200 dark:border-gray-700 pl-2" data-group-id="<%= group.id %>">
      <% group.children.order(:position, :name).each do |child| %>
        <%= render partial: "workflows/group_option", locals: { group: child, level: level + 1, selected_ids: selected_ids } %>
      <% end %>
    </div>
  <% end %>
</div>

